import{_ as $,u as E,i as P}from"./index-6c95d860.js";import{o as f,c as h,p as m,q,t as B,d as C,u as Q,v as W,r as y,x as D,y as A,z as X,g as k,A as M,B as N,f as _,w as v,C as b,D as O,F as j,G as R,H,I as Y,J as Z,K as G,L as ee,M as J,O as K,P as oe,Q as F,R as te,S as ne,T as se,h as L,U as ae,V as le}from"./vendor-90986b74.js";const ce={},re={class:"running-light-btn"},de={class:"light-btn"},ie={class:"light-btn-inner"};function ue(n,a){return f(),h("div",re,[m("button",de,[m("div",ie,[q(n.$slots,"default",{},()=>[B("button")],!0)])])])}const _e=$(ce,[["render",ue],["__scopeId","data-v-9fccf0c7"]]),pe=["xlink:href"],T=C({__name:"index",props:{name:{},prefix:{default:"icon"},iconStyle:{default:()=>({width:"24px",height:"24px"})}},setup(n){const a=n,o=Q(()=>`#${a.prefix}-${a.name}`);return(e,s)=>(f(),h("svg",{style:W(e.iconStyle),"aria-hidden":"true"},[m("use",{"xlink:href":o.value},null,8,pe)],4))}}),me=C({__name:"index",props:{seconds:{default:20},controlSignal:{}},emits:["getCountdownState","getCurCountdownTime"],setup(n,{emit:a}){const o=n,e=y(o.seconds),s=y();D(e,t=>{a("getCurCountdownTime",t),o.seconds!==0&&t===0&&a("getCountdownState","overed")});function r(t,d,p=1e3){let i=0,w=null;const x=Date.now();function g(){i++;const V=Date.now()-(x+i*p),U=p-V<=0?0:p-V,I=t*1e3-(Date.now()-x);if(d(Math.round(I/1e3)),I<=0||s.value!=="working"){clearTimeout(w);return}clearTimeout(w),w=setTimeout(g,U)}w=setTimeout(g,p)}D(()=>o.controlSignal,t=>{t&&{start:c,pause:l,reset:u}[t]()});function c(){a("getCountdownState","working"),s.value="working",r(e.value,t=>{s.value==="working"&&(e.value=t)})}function l(){a("getCountdownState","pause"),s.value="pause"}function u(){a("getCountdownState","initial"),s.value="initial",e.value=o.seconds}return(t,d)=>q(t.$slots,"countdown",{seconds:e.value})}});function fe(n){const a=Math.floor(n/60),o=n%60,e=Math.floor(a/60),s=a%60,r=Math.floor(e/24),c=e%24,l=r.toString().padStart(2,"0"),u=c.toString().padStart(2,"0"),t=s.toString().padStart(2,"0"),d=o.toString().padStart(2,"0"),p=`${l}天 ${u}:${t}:${d}`,i=`${u}:${t}:${d}`,w=`${t}:${d}`;return{days:l,hours:u,minutes:t,seconds:d,ddhhmmss:p,hhmmss:i,mmss:w}}function ge(n){return n===null?"null":typeof n!="object"?typeof n:Object.prototype.toString.call(n).slice(8,-1).toLocaleLowerCase()}const S=(n,a)=>{if(a){const{icon:o,type:e="info",dangerouslyUseHTMLString:s=!1,customClass:r="antd",duration:c=4e3,showClose:l=!1,center:u=!1,offset:t=20,appendTo:d=document.body,grouping:p=!1,onClose:i}=a;return A({message:n,type:e,icon:o,dangerouslyUseHTMLString:s,duration:c,showClose:l,center:u,offset:t,appendTo:d,grouping:p,customClass:r==="antd"?"pure-message":"",onClose:()=>{i&&ge(i)==="function"&&i()}})}else return A({message:n,customClass:"pure-message"})},ve={class:"countdown-controller"},he={class:"bar--left"},ye={class:"food--name"},we={class:"bar-right"},Ce={class:"countdown-time-wrapper"},xe={class:"countdown-time"},be=C({__name:"index",props:{foodName:{},countdownTotalTime:{}},setup(n){const a=n;X(t=>({f1871320:s.value}));const o=y("initial");function e(t){o.value=t}D(o,t=>{t==="working"&&S(`${a.foodName} 开始计时`,{type:"success",center:!0})});const s=y();function r(t){s.value=100-Math.round(t/a.countdownTotalTime*100)+"%"}const c=y("reset");let l=0;function u(){l++,l>1&&(l=0);const t={0:"reset",1:"start"};c.value=t[l]}return(t,d)=>(f(),h("div",{class:O(["hotpot-countdown-bar",o.value==="overed"?"countdown--overed":""])},[m("div",{class:O(["hotpot-countdown-bar-inner"]),onClick:u},[m("div",ve,[o.value==="initial"?(f(),k(T,{key:0,name:"kaishi",class:"controller-icon--start"})):M("",!0),o.value==="working"?(f(),k(T,{key:1,name:"tingzhi",class:"controller-icon--reset"})):M("",!0),o.value==="overed"?(f(),k(T,{key:2,name:"chongxinbofang",class:"controller-icon--again"})):M("",!0)]),m("div",he,[m("div",ye,N(o.value==="overed"?`${t.foodName} 开吃啦！`:t.foodName),1)]),m("div",we,[m("div",Ce,[_(me,{"control-signal":c.value,seconds:t.countdownTotalTime,onGetCountdownState:e,onGetCurCountdownTime:r},{countdown:v(p=>[m("div",xe,N(b(fe)(p.seconds).mmss),1)]),_:1},8,["control-signal","seconds"])])])])],2))}});const Se=$(be,[["__scopeId","data-v-8b178600"]]),$e={class:"hotpot-bar-list"},ke=C({__name:"CountdownBarList",setup(n){const a=E();return(o,e)=>(f(),h("div",$e,[(f(!0),h(j,null,R(b(a).getSortedSelectedFoodsByTime,s=>(f(),k(Se,{key:s.id,"food-name":s.name,"countdown-total-time":s.cooking_time},null,8,["food-name","countdown-total-time"]))),128))]))}}),Fe={class:"hotpot-foodslist-card"},Te={class:"card-header"},Be={class:"header--title"},De={class:"header-btn"},Ee={class:"card-content"},Ve={class:"content-inner"},Ie=["onClick"],Le=C({__name:"index",props:{category:{},foods:{}},emits:["add-food"],setup(n,{emit:a}){const o=n,e=E();function s(r){e.selectedFoods.includes(r)?e.selectedFoods=e.selectedFoods.filter(c=>c.id!==r.id):e.selectedFoods.push(r)}return(r,c)=>{const l=T;return f(),h("div",Fe,[m("div",Te,[m("div",Be,N(b(P)[o.category])+"：",1),m("div",De,[m("div",{class:"btn-add-food",onClick:c[0]||(c[0]=u=>a("add-food",o.category))},[_(l,{name:"plus"})])])]),m("div",Ee,[m("div",Ve,[(f(!0),h(j,null,R(o.foods,u=>(f(),h("div",{key:u.id,class:O({"content-item":!0,"content-item--selected":b(e).selectedFoods.includes(u)}),onClick:t=>s(u)},N(u.name),11,Ie))),128))])])])}}});const Me=$(Le,[["__scopeId","data-v-b67f1f3d"]]),Ne=n=>(J("data-v-8f534b1f"),n=n(),K(),n),Ue={class:"hotpot-add-food"},Oe={class:"form-btns"},je=Ne(()=>m("div",{class:"explanation-text"},"*数据存储在本地，切换设备将会丢失数据",-1)),Re=C({__name:"index",props:{categrory:{}},emits:["foodSubmit","cancel"],setup(n,{emit:a}){const o=n,e=H({name:"",cooking_time:"",description:""}),s=y();s.value=P[o.categrory];const r=H({name:[{required:!0,message:"请输入食材名",trigger:"blur"},{min:1,max:5,message:"请输入有效长度",trigger:"blur"}],cooking_time:[{required:!0,message:"请输入烹饪时间",trigger:"blur"},{min:1,message:"请输入有效时间",trigger:"blur"}]}),c=E(),l=y(),u=t=>{t&&t.validate(d=>{if(d){a("foodSubmit");const p={id:Date.now(),name:e.name,cooking_time:+e.cooking_time,description:e.description,category:o.categrory},i=c.isExist(p);c.addFood(p),i?S(`编辑${e.name}成功`,{type:"success"}):S(`添加${e.name}成功`,{type:"success"})}else return S("添加失败",{type:"error"}),!1})};return(t,d)=>{const p=Y,i=Z,w=G,x=ee;return f(),h("div",Ue,[_(x,{ref_key:"formRef",ref:l,rules:r,"label-position":"top","label-width":"80vw",model:e,style:{"max-width":"460px"}},{default:v(()=>[_(i,{label:"食材名称：",prop:"name"},{default:v(()=>[_(p,{modelValue:e.name,"onUpdate:modelValue":d[0]||(d[0]=g=>e.name=g),modelModifiers:{trim:!0},autofocus:"",placeholder:"输入已存在的食材，则为编辑"},null,8,["modelValue"])]),_:1}),_(i,{label:"倒计时间（秒）：",prop:"cooking_time"},{default:v(()=>[_(p,{type:"number",modelValue:e.cooking_time,"onUpdate:modelValue":d[1]||(d[1]=g=>e.cooking_time=g)},null,8,["modelValue"])]),_:1}),_(i,{label:"种类：",prop:"category"},{default:v(()=>[_(p,{"model-value":s.value,disabled:""},null,8,["model-value"])]),_:1}),_(i,{label:"描述：",prop:"description"},{default:v(()=>[_(p,{modelValue:e.description,"onUpdate:modelValue":d[2]||(d[2]=g=>e.description=g)},null,8,["modelValue"])]),_:1}),_(i,null,{default:v(()=>[m("div",Oe,[_(w,{onClick:d[3]||(d[3]=g=>a("cancel"))},{default:v(()=>[B("取消")]),_:1}),_(w,{type:"primary",onClick:d[4]||(d[4]=g=>u(l.value))},{default:v(()=>[B("添加")]),_:1})])]),_:1})]),_:1},8,["rules","model"]),je])}}});const ze=$(Re,[["__scopeId","data-v-8f534b1f"]]),Ae={class:"hotpot-dialog"},He=C({__name:"index",props:{dialogVisible:{type:Boolean},category:{}},emits:["dialogClosed"],setup(n,{emit:a}){const o=n,e=y(!1);D(()=>o.dialogVisible,c=>{c?e.value=!0:e.value=!1});const s=()=>{e.value=!1},r=()=>{e.value=!1};return(c,l)=>{const u=oe;return f(),h("div",Ae,[_(u,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=t=>e.value=t),width:"80vw",center:"",title:"添加/修改食材","destroy-on-close":"",onClose:l[1]||(l[1]=t=>a("dialogClosed"))},{default:v(()=>[_(ze,{categrory:o.category,onFoodSubmit:s,onCancel:r},null,8,["categrory"])]),_:1},8,["modelValue"])])}}}),Pe=()=>({exportExcel:(o,e,s="第一页")=>{const r=F.json_to_sheet(o),c=F.book_new();F.book_append_sheet(c,r,s),te(c,`${e}.xls`)},parseExcel:async o=>{if(!/\.(xlsx|xls|csv)$/.test(o.name))throw new Error("文件格式错误，请上传 Excel 文件");const s=await(async l=>{const u=await l.arrayBuffer();return ne(u).Sheets})(o),r=[],c=[];return Object.keys(s).forEach(l=>{r.push(F.sheet_to_json(s[l])),c.push(F.sheet_to_html(s[l]))}),Promise.resolve({sheetsJSON:r,sheetsHTML:c})}}),qe={class:"foods-list"},Ge={class:"foods-list-btns"},Je=C({__name:"index",props:{foods:{}},setup(n){const a=n,o=y(!1),e=y("beans"),s=i=>{o.value=!0,e.value=i},r=()=>{o.value=!1},c=E(),l=()=>{se.confirm(L("p",null,[L("span",null,"重置食材列表前，建议"),L("span",{style:"color: teal;font-weight: 700; cursor: pointer;",onClick:d}," 导出备份 "),L("span",null,"食材数据，以免添加的食材丢失，确认重置吗?")]),"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{c.resetAllfoods(),S("重置成功",{type:"success"})}).catch(()=>{})},{exportExcel:u,parseExcel:t}=Pe(),d=()=>{u(c.allfoods,"火锅食材列表"),S("导出食材列表成功",{type:"success"})},p=async()=>{let i;const x=await(()=>new Promise(U=>{document&&(i=document.createElement("input"),i.type="file",i.accept=".xls,.xlsx",i.style.display="none",i.onchange=I=>{const z=I.target;z.files&&U(z.files[0])},i.click())}))(),{sheetsJSON:g}=await t(x),V=g[0];c.applyImportedFoods(V),S("导入成功",{type:"success"})};return(i,w)=>{const x=G;return f(),h("div",qe,[(f(!0),h(j,null,R(a.foods,g=>(f(),k(Me,{key:g.category,category:g.category,foods:g.list,onAddFood:s},null,8,["category","foods"]))),128)),m("div",Ge,[_(x,{type:"primary",link:"",onClick:l},{default:v(()=>[B("重置菜单")]),_:1}),_(x,{type:"primary",link:"",onClick:p},{default:v(()=>[B("导入菜单")]),_:1})]),_(He,{"dialog-visible":o.value,category:e.value,onDialogClosed:r},null,8,["dialog-visible","category"])])}}});const Ke=$(Je,[["__scopeId","data-v-29381692"]]),Qe=n=>(J("data-v-453b2579"),n=n(),K(),n),We={class:"hotpot-foods-select-list"},Xe=Qe(()=>m("h3",{class:"food-list-header"},"食材列表",-1)),Ye=C({__name:"FoodsSelectedList",props:{openDrawer:{type:Boolean},foodsList:{}},emits:["drawerClose"],setup(n,{emit:a}){const o=n,e=y(!1);return D(()=>o.openDrawer,s=>e.value=s),(s,r)=>{const c=ae;return f(),h("div",We,[_(c,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=l=>e.value=l),direction:"btt",onClose:r[1]||(r[1]=l=>a("drawerClose")),size:"60%"},{header:v(()=>[Xe]),default:v(()=>[_(Ke,{class:"food-list",foods:o.foodsList},null,8,["foods"])]),_:1},8,["modelValue"])])}}});const Ze=$(Ye,[["__scopeId","data-v-453b2579"]]),eo=""+new URL("../png/dog-6cba3748.png",import.meta.url).href,oo={class:"hotpot-home"},to=C({__name:"index",setup(n){const a=y(!1),o=E();function e(){a.value=!0}function s(){a.value=!1}return(r,c)=>{const l=le,u=T,t=_e;return f(),h("div",oo,[b(o).getSortedSelectedFoodsByTime.length===0?(f(),k(l,{key:0,class:"empty-description",image:b(eo),description:"点击下方按钮添加食材计时"},null,8,["image"])):M("",!0),_(ke),_(Ze,{"open-drawer":a.value,"foods-list":b(o).getCategoryFoods,onDrawerClose:s},null,8,["open-drawer","foods-list"]),_(t,{class:"btn-add-food",onClick:e},{default:v(()=>[_(u,{class:"btn-icon",name:"plus"})]),_:1})])}}});const ao=$(to,[["__scopeId","data-v-455046f0"]]);export{ao as default};
