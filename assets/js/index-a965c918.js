import{_ as S,u as D,i as H}from"./index-a89755b6.js";import{o as m,c as h,n as p,p as q,q as F,d as C,t as y,u as T,v as X,x as Y,y as R,z as Z,e as k,A as L,B as M,b as i,w as g,C as x,D as U,F as O,G as j,r as G,H as J,I as A,J as ee,K as oe,L as K,M as te,O as Q,P as W,Q as ne,R as $,S as se,T as ae,U as le,h as I,V as ce,W as de}from"./vendor-4c082a3b.js";const re={},ie={class:"running-light-btn"},ue={class:"light-btn",id:"line"},_e={class:"light-btn-inner"};function pe(n,a){return m(),h("div",ie,[p("button",ue,[p("div",_e,[q(n.$slots,"default",{},()=>[F("button")],!0)])])])}const me=S(re,[["render",pe],["__scopeId","data-v-7d2259f7"]]),fe=C({__name:"index",props:{seconds:{default:20},controlSignal:{}},emits:["getCountdownState","getCurCountdownTime"],setup(n,{emit:a}){const t=n,e=y(t.seconds),s=y();T(e,o=>{a("getCurCountdownTime",o),t.seconds!==0&&o===0&&a("getCountdownState","overed")});function d(o,r,f=1e3){let u=0,w=null;const b=Date.now();function v(){u++;const V=Date.now()-(b+u*f),N=f-V<=0?0:f-V,E=o*1e3-(Date.now()-b);if(r(Math.round(E/1e3)),E<=0||s.value!=="working"){clearTimeout(w);return}clearTimeout(w),w=setTimeout(v,N)}w=setTimeout(v,f)}T(()=>t.controlSignal,o=>{o&&{start:c,pause:l,reset:_}[o]()});function c(){a("getCountdownState","working"),s.value="working",d(e.value,o=>{s.value==="working"&&(e.value=o)})}function l(){a("getCountdownState","pause"),s.value="pause"}function _(){a("getCountdownState","initial"),s.value="initial",e.value=t.seconds}return(o,r)=>q(o.$slots,"countdown",{seconds:e.value})}}),ge=["xlink:href"],P=C({__name:"index",props:{name:{},prefix:{default:"icon"},iconStyle:{default:()=>({width:"24px",height:"24px"})}},setup(n){const a=n,t=X(()=>`#${a.prefix}-${a.name}`);return(e,s)=>(m(),h("svg",{style:Y(e.iconStyle),"aria-hidden":"true"},[p("use",{"xlink:href":t.value},null,8,ge)],4))}});function ve(n){const a=Math.floor(n/60),t=n%60,e=Math.floor(a/60),s=a%60,d=Math.floor(e/24),c=e%24,l=d.toString().padStart(2,"0"),_=c.toString().padStart(2,"0"),o=s.toString().padStart(2,"0"),r=t.toString().padStart(2,"0"),f=`${l}天 ${_}:${o}:${r}`,u=`${_}:${o}:${r}`,w=`${o}:${r}`;return{days:l,hours:_,minutes:o,seconds:r,ddhhmmss:f,hhmmss:u,mmss:w}}function he(n){return n===null?"null":typeof n!="object"?typeof n:Object.prototype.toString.call(n).slice(8,-1).toLocaleLowerCase()}const B=(n,a)=>{if(a){const{icon:t,type:e="info",dangerouslyUseHTMLString:s=!1,customClass:d="antd",duration:c=4e3,showClose:l=!1,center:_=!1,offset:o=20,appendTo:r=document.body,grouping:f=!1,onClose:u}=a;return R({message:n,type:e,icon:t,dangerouslyUseHTMLString:s,duration:c,showClose:l,center:_,offset:o,appendTo:r,grouping:f,customClass:d==="antd"?"pure-message":"",onClose:()=>{u&&he(u)==="function"&&u()}})}else return R({message:n,customClass:"pure-message"})},ye={class:"countdown-controller"},we={class:"bar--left"},Ce={class:"food--name"},be={class:"bar-right"},xe={class:"countdown-time-wrapper"},Se={class:"countdown-time"},ke=C({__name:"index",props:{foodName:{},countdownTotalTime:{}},setup(n){const a=n;Z(o=>({"87308a38":s.value}));const t=y("initial");function e(o){t.value=o}T(t,o=>{o==="working"&&B(`${a.foodName} 开始计时`,{type:"success",center:!0})});const s=y();function d(o){s.value=100-Math.round(o/a.countdownTotalTime*100)+"%"}const c=y("reset");let l=0;function _(){l++,l>1&&(l=0);const o={0:"reset",1:"start"};c.value=o[l]}return(o,r)=>(m(),h("div",{class:U(["hotpot-countdown-bar",t.value==="overed"?"countdown--overed":""])},[p("div",{class:U(["hotpot-countdown-bar-inner"]),onClick:_},[p("div",ye,[t.value==="initial"?(m(),k(P,{key:0,name:"kaishi",class:"controller-icon--start"})):L("",!0),t.value==="working"?(m(),k(P,{key:1,name:"tingzhi",class:"controller-icon--reset"})):L("",!0),t.value==="overed"?(m(),k(P,{key:2,name:"chongxinbofang",class:"controller-icon--again"})):L("",!0)]),p("div",we,[p("div",Ce,M(t.value==="overed"?`${o.foodName} 开吃啦！`:o.foodName),1)]),p("div",be,[p("div",xe,[i(fe,{"control-signal":c.value,seconds:o.countdownTotalTime,onGetCountdownState:e,onGetCurCountdownTime:d},{countdown:g(f=>[p("div",Se,M(x(ve)(f.seconds).mmss),1)]),_:1},8,["control-signal","seconds"])])])])],2))}});const $e=S(ke,[["__scopeId","data-v-2bfebbe0"]]),Fe={class:"hotpot-bar-list"},Te=C({__name:"CountdownBarList",setup(n){const a=D();return(t,e)=>(m(),h("div",Fe,[(m(!0),h(O,null,j(x(a).getSortedSelectedFoodsByTime,s=>(m(),k($e,{key:s.id,"food-name":s.name,"countdown-total-time":s.cooking_time},null,8,["food-name","countdown-total-time"]))),128))]))}}),Be={class:"hotpot-foodslist-card"},De={class:"card-header"},Ve={class:"header--title"},Ee={class:"header-btn"},Ie={class:"card-content"},Le={class:"content-inner"},Me=["onClick"],Ne=C({__name:"index",props:{category:{},foods:{}},emits:["add-food"],setup(n,{emit:a}){const t=n,e=D();function s(d){e.selectedFoods.includes(d)?e.selectedFoods=e.selectedFoods.filter(c=>c.id!==d.id):e.selectedFoods.push(d)}return(d,c)=>{const l=G("Plus"),_=J;return m(),h("div",Be,[p("div",De,[p("div",Ve,M(x(H)[t.category])+"：",1),p("div",Ee,[p("div",{class:"btn-add-food",onClick:c[0]||(c[0]=o=>a("add-food",t.category))},[i(_,{color:"#999"},{default:g(()=>[i(l)]),_:1})])])]),p("div",Ie,[p("div",Le,[(m(!0),h(O,null,j(t.foods,o=>(m(),h("div",{key:o.id,class:U({"content-item":!0,"content-item--selected":x(e).selectedFoods.includes(o)}),onClick:r=>s(o)},M(o.name),11,Me))),128))])])])}}});const Pe=S(Ne,[["__scopeId","data-v-d450184d"]]),Ue=n=>(Q("data-v-a0e16c5e"),n=n(),W(),n),Oe={class:"hotpot-add-food"},je={class:"form-btns"},ze=Ue(()=>p("div",{class:"explanation-text"},"*数据存储在本地，切换设备将会丢失数据",-1)),Re=C({__name:"index",props:{categrory:{}},emits:["foodSubmit","cancel"],setup(n,{emit:a}){const t=n,e=A({name:"",cooking_time:"",description:""}),s=y();s.value=H[t.categrory];const d=A({name:[{required:!0,message:"请输入食材名",trigger:"blur"},{min:1,max:5,message:"请输入有效长度",trigger:"blur"}],cooking_time:[{required:!0,message:"请输入烹饪时间",trigger:"blur"},{min:1,message:"请输入有效时间",trigger:"blur"}]}),c=D(),l=y(),_=o=>{o&&o.validate(r=>{if(r){a("foodSubmit");const f={id:Date.now(),name:e.name,cooking_time:+e.cooking_time,description:e.description,category:t.categrory};c.addFood(f),B(`添加${e.name}成功`,{type:"success"})}else return B("添加失败",{type:"error"}),!1})};return(o,r)=>{const f=ee,u=oe,w=K,b=te;return m(),h("div",Oe,[i(b,{ref_key:"formRef",ref:l,rules:d,"label-position":"top","label-width":"80vw",model:e,style:{"max-width":"460px"}},{default:g(()=>[i(u,{label:"食材名称：",prop:"name"},{default:g(()=>[i(f,{modelValue:e.name,"onUpdate:modelValue":r[0]||(r[0]=v=>e.name=v),modelModifiers:{trim:!0},autofocus:""},null,8,["modelValue"])]),_:1}),i(u,{label:"倒计时间（秒）：",prop:"cooking_time"},{default:g(()=>[i(f,{type:"number",modelValue:e.cooking_time,"onUpdate:modelValue":r[1]||(r[1]=v=>e.cooking_time=v)},null,8,["modelValue"])]),_:1}),i(u,{label:"种类：",prop:"category"},{default:g(()=>[i(f,{"model-value":s.value,disabled:""},null,8,["model-value"])]),_:1}),i(u,{label:"描述：",prop:"description"},{default:g(()=>[i(f,{modelValue:e.description,"onUpdate:modelValue":r[2]||(r[2]=v=>e.description=v)},null,8,["modelValue"])]),_:1}),i(u,null,{default:g(()=>[p("div",je,[i(w,{type:"primary",onClick:r[3]||(r[3]=v=>_(l.value))},{default:g(()=>[F("添加")]),_:1}),i(w,{onClick:r[4]||(r[4]=v=>a("cancel"))},{default:g(()=>[F("取消")]),_:1})])]),_:1})]),_:1},8,["rules","model"]),ze])}}});const Ae=S(Re,[["__scopeId","data-v-a0e16c5e"]]),He={class:"hotpot-dialog"},qe=C({__name:"index",props:{dialogVisible:{type:Boolean},category:{}},emits:["dialogClosed"],setup(n,{emit:a}){const t=n,e=y(!1);T(()=>t.dialogVisible,c=>{c?e.value=!0:e.value=!1});const s=()=>{e.value=!1},d=()=>{e.value=!1};return(c,l)=>{const _=ne;return m(),h("div",He,[i(_,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value=o),width:"80vw",center:"",title:"添加/修改食材","destroy-on-close":"",onClose:l[1]||(l[1]=o=>a("dialogClosed"))},{default:g(()=>[i(Ae,{categrory:t.category,onFoodSubmit:s,onCancel:d},null,8,["categrory"])]),_:1},8,["modelValue"])])}}}),Ge=()=>({exportExcel:(t,e,s="第一页")=>{const d=$.json_to_sheet(t),c=$.book_new();$.book_append_sheet(c,d,s),se(c,`${e}.xls`)},parseExcel:async t=>{if(!/\.(xlsx|xls|csv)$/.test(t.name))throw new Error("文件格式错误，请上传 Excel 文件");const s=await(async l=>{const _=await l.arrayBuffer();return ae(_).Sheets})(t),d=[],c=[];return Object.keys(s).forEach(l=>{d.push($.sheet_to_json(s[l])),c.push($.sheet_to_html(s[l]))}),Promise.resolve({sheetsJSON:d,sheetsHTML:c})}}),Je={class:"foods-list"},Ke={class:"foods-list-btns"},Qe=C({__name:"index",props:{foods:{}},setup(n){const a=n,t=y(!1),e=y("beans"),s=u=>{t.value=!0,e.value=u},d=()=>{t.value=!1},c=D(),l=()=>{le.confirm(I("p",null,[I("span",null,"重置食材列表前，建议"),I("span",{style:"color: teal;font-weight: 700; cursor: pointer;",onClick:r}," 导出备份 "),I("span",null,"食材数据，以免添加的食材丢失，确认重置吗?")]),"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{c.resetAllfoods(),B("重置成功",{type:"success"})}).catch(()=>{})},{exportExcel:_,parseExcel:o}=Ge(),r=()=>{_(c.allfoods,"火锅食材列表")},f=async()=>{let u;const b=await(()=>new Promise(N=>{document&&(u=document.createElement("input"),u.type="file",u.accept=".xls,.xlsx",u.style.display="none",u.onchange=E=>{const z=E.target;z.files&&N(z.files[0])},u.click())}))(),{sheetsJSON:v}=await o(b),V=v[0];c.applyImportedFoods(V),B("导入成功",{type:"success"})};return(u,w)=>{const b=K;return m(),h("div",Je,[(m(!0),h(O,null,j(a.foods,v=>(m(),k(Pe,{key:v.category,category:v.category,foods:v.list,onAddFood:s},null,8,["category","foods"]))),128)),p("div",Ke,[i(b,{type:"primary",link:"",onClick:l},{default:g(()=>[F("重置菜单")]),_:1}),i(b,{type:"primary",link:"",onClick:f},{default:g(()=>[F("导入菜单")]),_:1})]),i(qe,{"dialog-visible":t.value,category:e.value,onDialogClosed:d},null,8,["dialog-visible","category"])])}}});const We=S(Qe,[["__scopeId","data-v-7cfb6e46"]]),Xe=n=>(Q("data-v-453b2579"),n=n(),W(),n),Ye={class:"hotpot-foods-select-list"},Ze=Xe(()=>p("h3",{class:"food-list-header"},"食材列表",-1)),eo=C({__name:"FoodsSelectedList",props:{openDrawer:{type:Boolean},foodsList:{}},emits:["drawerClose"],setup(n,{emit:a}){const t=n,e=y(!1);return T(()=>t.openDrawer,s=>e.value=s),(s,d)=>{const c=ce;return m(),h("div",Ye,[i(c,{modelValue:e.value,"onUpdate:modelValue":d[0]||(d[0]=l=>e.value=l),direction:"btt",onClose:d[1]||(d[1]=l=>a("drawerClose")),size:"60%"},{header:g(()=>[Ze]),default:g(()=>[i(We,{class:"food-list",foods:t.foodsList},null,8,["foods"])]),_:1},8,["modelValue"])])}}});const oo=S(eo,[["__scopeId","data-v-453b2579"]]),to=""+new URL("../png/dog-6cba3748.png",import.meta.url).href,no={class:"hotpot"},so=C({__name:"index",setup(n){const a=y(!1),t=D();function e(){a.value=!0}function s(){a.value=!1}return(d,c)=>{const l=de,_=G("Plus"),o=J,r=me;return m(),h("div",no,[x(t).getSortedSelectedFoodsByTime.length===0?(m(),k(l,{key:0,class:"empty-description",image:x(to),description:"点击下方按钮添加食材计时"},null,8,["image"])):L("",!0),i(Te),i(oo,{"open-drawer":a.value,"foods-list":x(t).getCategoryFoods,onDrawerClose:s},null,8,["open-drawer","foods-list"]),i(r,{class:"btn-add-food",onClick:e},{default:g(()=>[i(o,{class:"btn-icon",size:20},{default:g(()=>[i(_)]),_:1})]),_:1})])}}});const co=S(so,[["__scopeId","data-v-ebcca7e8"]]);export{co as default};
